<div class="container">
  <p-card>
    <h3>設備請購單</h3>

    <div
      style="display: flex; justify-content: flex-end; align-items: flex-start"
    >

      <p-button
        (click)="newDialog()"
        pTooltip="新增"
        tooltipPosition="top"
        icon="pi pi-plus"
        styleClass="p-button-text"
      ></p-button>

    </div>
    <p-divider></p-divider>

    <p-table [value]="apiData" [tableStyle]="{ 'min-width': '50rem' }">
      <ng-template pTemplate="header">
        <tr>
          <th>Applicant</th>
          <th>Requisition Number</th>
          <th>Company Name</th>
          <th>Requisition Department</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-purchases>
        <tr>
          <td>{{ purchases.applicant }}</td>
          <td>{{ purchases.position}}</td>
          <td>{{ purchases.company_name }}</td>
          <td>{{ purchases.requisition_department }}</td>
          <td>
            <p-button
              (click)="showDialog(purchases)"
              icon="pi pi-pencil"
              styleClass="p-button-rounded p-button-secondary p-button-outlined"
            ></p-button>
          </td>
          <td>
            <p-button
              (click)="delete(purchases.purchase_id)"
              icon="pi pi-trash"
              styleClass="p-button-rounded p-button-secondary p-button-outlined"
            ></p-button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-card>
</div>

<!--新增-->
<!--Dialog-->
<form [formGroup]="form">
  <p-dialog
    [(visible)]="addData"
    header="新增"
    [style]="{ width: '45vw', height: '800px' }"
  >
    <div class="formgrid grid">
      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>申請人</label>
        <p class="line-height-1 w-10">
          <input formControlName="applicant" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label>請購編號</label>
        <p class="text-left">
          <dd>{{(form.controls['position'].value)}}</dd>
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>公司名稱</label>
        <p class="line-height-1 w-10">
          <input formControlName="company_name" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>請購部門</label>
        <p class="line-height-1 w-10">
          <input formControlName="requisition_department" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>品名</label>
        <p class="line-height-1 w-10">
          <input formControlName="product" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>請購數量</label>
        <p class="line-height-1 w-10">
          <input formControlName="requisition_quantity" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>單價</label>
        <p class="line-height-1 w-10">
          <input formControlName="price" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>創建者</label>
        <p class="line-height-1 w-10">
          <input formControlName="created_by" pInputText />
        </p>
      </div>

      <div class="ml-auto">
        <p-button
          (click)="post()"
          label="新增"
          styleClass="p-button-raised p-button-text"
        ></p-button>
        <p-button
          (click)="addData = false"
          label="取消"
          styleClass="p-button-rounded p-button-secondary"
        ></p-button>
      </div>

    </div>

  </p-dialog>
</form>

<!--編輯-->>
<!--Dialog-->
<form [formGroup]="form">
  <p-dialog
    [(visible)]="visible"
    header="編輯"
    [style]="{ width: '45vw', height: '800px' }"
  >
    <div class="formgrid grid">
      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>申請人</label>
        <p class="line-height-1 w-10">
          <input formControlName="applicant" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label>請購編號</label>
        <p class="text-left">
          <dd>{{(form.controls['position'].value)}}</dd>
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>公司名稱</label>
        <p class="line-height-1 w-10">
          <input formControlName="company_name" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>請購部門</label>
        <p class="line-height-1 w-10">
          <input formControlName="requisition_department" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>品名</label>
        <p class="line-height-1 w-10">
          <input formControlName="product" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>請購數量</label>
        <p class="line-height-1 w-10">
          <input formControlName="requisition_quantity" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>單價</label>
        <p class="line-height-1 w-10">
          <input formControlName="price" pInputText />
        </p>
      </div>

      <div class="field col-12 md:col-6">
        <label><span class="required">*</span>創建者</label>
        <p class="line-height-1 w-10">
          <input formControlName="created_by" pInputText />
        </p>
      </div>

      <div class="ml-auto">
        <p-button
          (click)="patch(id)"
          label="儲存"
          styleClass="p-button-raised p-button-text"
        ></p-button>
        <p-button
          (click)="cancel()"
          label="取消"
          styleClass="p-button-rounded p-button-secondary"
        ></p-button>
      </div>

    </div>
  </p-dialog>
</form>
